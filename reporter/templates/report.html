<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Scan Report - {{ data.target }}</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { color: #222; }
    table { border-collapse: collapse; width: 100%; margin-top: 12px; }
    th, td { border: 1px solid #bbb; padding: 8px; text-align: left; }
    th { background: #eee; }
    .high { background: #ffd6d6; }
    .medium { background: #fff0b3; }
    .low { background: #e8ffe8; }
    pre { background: #f6f6f6; padding: 8px; border: 1px solid #ddd; overflow:auto; }
  </style>
</head>
<body>
  <h1>Recon & Assessment Report</h1>
  <p><strong>Target:</strong> {{ data.target }}</p>
  <p><strong>Summary:</strong> {{ data.open_count }} open ports found.</p>

  <h2>Findings</h2>
  <table>
    <thead>
      <tr><th>Port</th><th>Service</th><th>Product / Version</th><th>Banner</th><th>Severity</th><th>Notes</th></tr>
    </thead>
    <tbody>
    {% for p in data.open_ports %}
      <tr class="{{ p.severity }}">
        <td>{{ p.port }}/{{ p.protocol }}</td>
        <td>{{ p.service }}</td>
        <td>{{ p.product }} {{ p.version }}</td>
        <td><pre>{{ p.banner or '' }}</pre></td>
        <td>{{ p.severity }}</td>
        <td>{{ p.note }}</td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

  <h2>Raw JSON</h2>
  <pre>{{ data_raw }}</pre>
</body>
</html>
